server:
  address: "tcp://0.0.0.0:9091/"

log:
  level: debug
  format: text
  file_path: /var/log/authelia/authelia.log
  keep_stdout: true

telemetry:
  metrics:
    enabled: true

identity_validation:
  reset_password:
    jwt_secret: "${AUTHELIA_IDENTITY_VALIDATION_RESET_PASSWORD_JWT_SECRET}"

#authentication_backend:
#  file:
#    path: /config/users.yml
#    watch: true

authentication_backend:
  ldap:
    implementation: custom
    address: ldap://lldap
    start_tls: false

    base_dn: dc=home,dc=lan

    additional_users_dn: ou=people
    users_filter: (&({username_attribute}={input})(objectClass=person))

    additional_groups_dn: ou=groups
    groups_filter: (&(objectClass=groupOfNames)(member={dn}))

    user: uid=admin,ou=people,dc=home,dc=lan
    password: G970DyLT+QvRNLLoZ0Jo2ATiaBqJvDBU

access_control:
  default_policy: deny

  rules:

    - domain: nasautomation.home.smallfamilybusiness.net
      resources:
        - "^/api/.*"
      policy: bypass

    # Notwendig f√ºr das invite System des useradmin addons
    - domain: authelia.home.smallfamilybusiness.net
      resources:
        - "^/admin/invite.*"
        - "^/admin/api/invite.*"
      policy: bypass

    # Admin-Bereich (zwingend 2FA)
    - domain: authelia.home.smallfamilybusiness.net
      resources:
        - "^/admin.*"
      policy: two_factor
      subject:
        - "group:admins"

    # Admin-Tools (zwingend 2FA)
    - domain:
        - "traefik.home.smallfamilybusiness.net"
        - "wpdbadmin.home.smallfamilybusiness.net"
      policy: two_factor
      subject:
        - "group:admins"

    # Admin-Bereich deny users
    - domain: authelia.home.smallfamilybusiness.net
      resources:
        - "^/admin.*"
      policy: deny

    # Admin-Tools deny users
    - domain:
        - "traefik.home.smallfamilybusiness.net"
        - "wpdbadmin.home.smallfamilybusiness.net"
      policy: deny

    # Alle Subdomains (Standard: 1FA)
    - domain: "*.home.smallfamilybusiness.net"
      policy: one_factor

session:
  cookies:
    - name: authelia_session_home
      domain: home.smallfamilybusiness.net
      authelia_url: https://authelia.home.smallfamilybusiness.net
      same_site: none
      expiration: 3600
      inactivity: 300
      remember_me: '6M'

  secret: "${AUTHELIA_SESSION_SECRET}"

storage:
  encryption_key: "${AUTHELIA_STORAGE_ENCRYPTION_KEY}"
  local:
    path: /config/storage

# notifier:
#   filesystem:
#     filename: /config/notification.txt

